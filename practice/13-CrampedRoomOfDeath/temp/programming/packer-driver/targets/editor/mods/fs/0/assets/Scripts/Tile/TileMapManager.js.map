{"version":3,"sources":["file:///Users/lindanian/projects/git/cocos-creator-projects/practice/13-CrampedRoomOfDeath/assets/Scripts/Tile/TileMapManager.ts"],"names":["_decorator","Component","TileManager","createUINode","DataManager","ResourceManager","ccclass","property","TileMapManager","init","spriteFrames","Instance","loadDir","mapInfo","i","length","column","j","item","src","type","node","imgSrc","spriteFrame","find","v","name","tileManager","addComponent","setParent"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;;AAGbC,MAAAA,W,iBAAAA,W;;AACAC,MAAAA,Y,iBAAAA,Y;;AACDC,MAAAA,W;;AACAC,MAAAA,e;;;;;;;OALD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;gCAQjBQ,c,WADZF,OAAO,CAAC,gBAAD,C,gBAAR,MACaE,cADb,SACoCP,SADpC,CAC8C;AAChC,cAAJQ,IAAI,GAAI;AACV,gBAAMC,YAAY,GAAG,MAAM;AAAA;AAAA,kDAAgBC,QAAhB,CAAyBC,OAAzB,CAAiC,mBAAjC,CAA3B,CADU,CAEV;AACA;;AACA,gBAAM;AAAEC,YAAAA;AAAF,cAAc;AAAA;AAAA,0CAAYF,QAAhC;;AACA,eAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,OAAO,CAACE,MAA5B,EAAoCD,CAAC,EAArC,EAAyC;AACrC,kBAAME,MAAM,GAAGH,OAAO,CAACC,CAAD,CAAtB;;AACA,iBAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,MAAM,CAACD,MAA3B,EAAmCE,CAAC,EAApC,EAAwC;AACpC,oBAAMC,IAAI,GAAGF,MAAM,CAACC,CAAD,CAAnB;;AACA,kBAAGC,IAAI,CAACC,GAAL,KAAa,IAAb,IAAqBD,IAAI,CAACE,IAAL,KAAc,IAAtC,EAA2C;AACvC;AACH;;AACD,oBAAMC,IAAI,GAAG;AAAA;AAAA,iDAAb;AACA,oBAAMC,MAAM,GAAI,SAAQJ,IAAI,CAACC,GAAI,GAAjC;AACA,oBAAMI,WAAW,GAAGb,YAAY,CAACc,IAAb,CAAkBC,CAAC,IAAIA,CAAC,CAACC,IAAF,KAAWJ,MAAlC,KAA6CZ,YAAY,CAAC,CAAD,CAA7E;AACA,oBAAMiB,WAAW,GAAGN,IAAI,CAACO,YAAL;AAAA;AAAA,6CAApB;AACAD,cAAAA,WAAW,CAAClB,IAAZ,CAAiBc,WAAjB,EAA8BT,CAA9B,EAAiCG,CAAjC;AACAI,cAAAA,IAAI,CAACQ,SAAL,CAAe,KAAKR,IAApB;AACH;AACJ;AACJ,SArByC,CAuB1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAnC0C,O","sourcesContent":["import { _decorator, Component, Node, Sprite, resources, SpriteFrame, UITransform, Layers } from 'cc';\nconst { ccclass, property } = _decorator;\nimport Levels from \"db://assets/Levels\";\nimport {TileManager} from \"db://assets/Scripts/Tile/TileManager\";\nimport {createUINode} from \"db://assets/Utils\";\nimport DataManager from \"db://assets/Runtime/DataManager\";\nimport ResourceManager from \"db://assets/Runtime/ResourceManager\";\n\n@ccclass('TileMapManager')\nexport class TileMapManager extends Component {\n    async init () {\n        const spriteFrames = await ResourceManager.Instance.loadDir(\"texture/tile/tile\");\n        // console.log('地图信息：', level );\n        // console.log(spriteFrames);\n        const { mapInfo } = DataManager.Instance;\n        for (let i = 0; i < mapInfo.length; i++) {\n            const column = mapInfo[i];\n            for (let j = 0; j < column.length; j++) {\n                const item = column[j];\n                if(item.src === null || item.type === null){\n                    continue\n                }\n                const node = createUINode();\n                const imgSrc = `tile (${item.src})`;\n                const spriteFrame = spriteFrames.find(v => v.name === imgSrc) || spriteFrames[0];\n                const tileManager = node.addComponent(TileManager);\n                tileManager.init(spriteFrame, i, j);\n                node.setParent(this.node);\n            }\n        }\n    }\n\n    // loadRes () {\n    //     return new Promise<SpriteFrame[]>((resolve, reject) => {\n    //         // 加载 test assets 目录下所有 SpriteFrame，并且获取它们的路径\n    //         resources.loadDir(\"texture/tile/tile\", SpriteFrame, function (err, assets) {\n    //             if(err){\n    //                 reject(err);\n    //                 return\n    //             }\n    //             resolve(assets);\n    //         });\n    //     });\n    //\n    // }\n}\n\n"]}