{"version":3,"sources":["file:///Users/lindanian/projects/git/cocos-creator-projects/practice/13-CrampedRoomOfDeath/assets/Base/EntityManager.ts"],"names":["_decorator","Component","Sprite","UITransform","TILE_HEIGHT","TILE_WIDTH","DIRECTION_ODER_ENUM","PARAMS_NAME_ENUM","ccclass","property","ANIMATION_SPEED","EntityManager","direction","_direction","newDirection","fsm","setParams","DIRECTION","state","_state","newState","init","params","sprite","addComponent","sizeMode","SizeMode","CUSTOM","transform","getComponent","setContentSize","x","y","type","update","node","setPosition"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAQA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;;AAC/BC,MAAAA,W,iBAAAA,W;AAAaC,MAAAA,U,iBAAAA,U;;AAIjBC,MAAAA,mB,iBAAAA,mB;AAGAC,MAAAA,gB,iBAAAA,gB;;;;;;;OAQE;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBT,U;AAExBU,MAAAA,e,GAAkB,IAAE,C;;+BAGbC,a,WADZH,OAAO,CAAC,eAAD,C,yBAAR,MACaG,aADb,SACmCV,SADnC,CAC6C;AAAA;AAAA;;AAAA,qCAC9B,CAD8B;;AAAA,qCAE9B,CAF8B;;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAS5B,YAATW,SAAS,GAAE;AACX,iBAAO,KAAKC,UAAZ;AACH;;AAEY,YAATD,SAAS,CAACE,YAAD,EAAc;AACvB,eAAKD,UAAL,GAAkBC,YAAlB;AACA,eAAKC,GAAL,CAASC,SAAT,CAAmB;AAAA;AAAA,oDAAiBC,SAApC,EAA+C;AAAA;AAAA,0DAAoB,KAAKJ,UAAzB,CAA/C;AACH;;AAEQ,YAALK,KAAK,GAAE;AACP,iBAAO,KAAKC,MAAZ;AACH,SApBwC,CAsBzC;;;AACS,YAALD,KAAK,CAACE,QAAD,EAAU;AACf,eAAKD,MAAL,GAAcC,QAAd;AACA,eAAKL,GAAL,CAASC,SAAT,CAAmB,KAAKG,MAAxB,EAAgC,IAAhC;AACH;;AAES,cAAJE,IAAI,CAACC,MAAD,EAAiB;AACvB,gBAAMC,MAAM,GAAG,KAAKC,YAAL,CAAkBtB,MAAlB,CAAf;AACAqB,UAAAA,MAAM,CAACE,QAAP,GAAkBvB,MAAM,CAACwB,QAAP,CAAgBC,MAAlC;AACA,gBAAMC,SAAS,GAAG,KAAKC,YAAL,CAAkB1B,WAAlB,CAAlB;AACAyB,UAAAA,SAAS,CAACE,cAAV,CAAyB;AAAA;AAAA,0CAAa,CAAtC,EAAyC;AAAA;AAAA,4CAAc,CAAvD;AAEA,eAAKC,CAAL,GAAST,MAAM,CAACS,CAAhB;AACA,eAAKC,CAAL,GAASV,MAAM,CAACU,CAAhB;AACA,eAAKC,IAAL,GAAYX,MAAM,CAACW,IAAnB;AACA,eAAKrB,SAAL,GAAiBU,MAAM,CAACV,SAAxB;AACA,eAAKM,KAAL,GAAaI,MAAM,CAACJ,KAApB;AACH;;AAEDgB,QAAAA,MAAM,GAAE;AACJ,eAAKC,IAAL,CAAUC,WAAV,CAAsB,KAAKL,CAAL;AAAA;AAAA,0CAAsB;AAAA;AAAA,uCAA5C,EAA8D,CAAC,KAAKC,CAAN;AAAA;AAAA,4CAAwB;AAAA;AAAA,yCAAtF;AACH;;AA3CwC,O","sourcesContent":["import {_decorator, Component, Sprite, UITransform} from 'cc';\nimport {TILE_HEIGHT, TILE_WIDTH} from \"db://assets/Scripts/Tile/TileManager\";\nimport {\n    CONTROLLER_ENUM,\n    DIRECTION_ENUM,\n    DIRECTION_ODER_ENUM,\n    ENTITY_STATE_ENUM, ENTITY_TYPE_ENUM,\n    EVENT_ENUM,\n    PARAMS_NAME_ENUM\n} from \"db://assets/Enums\";\nimport EventManager from \"db://assets/Runtime/EventManager\";\nimport {PlayerStateMachine} from \"db://assets/Scripts/Player/PlayerStateMachine\";\nimport {IEntity} from \"db://assets/Levels\";\nimport {WoodenSkeletonStateMachine} from \"db://assets/Scripts/WoodenSkeleton/WoodenSkeletonStateMachine\";\nimport {StateMachine} from \"db://assets/Base/StateMachine\";\n\nconst { ccclass, property } = _decorator;\n\nconst ANIMATION_SPEED = 1/8;\n\n@ccclass('EntityManager')\nexport class EntityManager extends Component {\n    x:number = 0\n    y:number = 0\n    fsm: StateMachine\n\n    private _direction: DIRECTION_ENUM\n    private _state: ENTITY_STATE_ENUM\n    private type: ENTITY_TYPE_ENUM\n\n    get direction(){\n        return this._direction;\n    }\n\n    set direction(newDirection){\n        this._direction = newDirection;\n        this.fsm.setParams(PARAMS_NAME_ENUM.DIRECTION, DIRECTION_ODER_ENUM[this._direction]);\n    }\n\n    get state(){\n        return this._state;\n    }\n\n    //数据驱动视图变化\n    set state(newState){\n        this._state = newState;\n        this.fsm.setParams(this._state, true);\n    }\n\n    async init(params: IEntity){\n        const sprite = this.addComponent(Sprite);\n        sprite.sizeMode = Sprite.SizeMode.CUSTOM;\n        const transform = this.getComponent(UITransform);\n        transform.setContentSize(TILE_WIDTH * 4, TILE_HEIGHT * 4);\n\n        this.x = params.x;\n        this.y = params.y;\n        this.type = params.type;\n        this.direction = params.direction;\n        this.state = params.state;\n    }\n\n    update(){\n        this.node.setPosition(this.x * TILE_WIDTH - 1.5 * TILE_WIDTH, -this.y * TILE_HEIGHT + 1.5 * TILE_HEIGHT);\n    }\n}\n\n"]}