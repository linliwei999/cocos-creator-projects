{"version":3,"sources":["file:///Users/lindanian/projects/git/cocos-creator-projects/practice/13-CrampedRoomOfDeath/assets/Runtime/EventManager.ts"],"names":["EventManager","Singleton","Map","Instance","GetInstance","on","eventName","func","ctx","eventDic","has","get","push","set","off","index","findIndex","i","splice","emit","params","forEach","apply","clear"],"mappings":";;;yCAQqBA,Y;;;;;;;;;;;;;;;;AAPdC,MAAAA,S;;;;;;;yBAOcD,Y,GAAN,MAAMA,YAAN;AAAA;AAAA,kCAAoC;AAAA;AAAA;;AAAA,4CAID,IAAIE,GAAJ,EAJC;AAAA;;AAC5B,mBAARC,QAAQ,GAAE;AACjB,iBAAO,MAAMC,WAAN,EAAP;AACH;;AAGD;AACA;AACAC,QAAAA,EAAE,CAACC,SAAD,EAAoBC,IAApB,EAAoCC,GAApC,EAAkD;AAChD,cAAG,KAAKC,QAAL,CAAcC,GAAd,CAAkBJ,SAAlB,CAAH,EAAgC;AAC5B,iBAAKG,QAAL,CAAcE,GAAd,CAAkBL,SAAlB,EAA6BM,IAA7B,CAAkC;AAACL,cAAAA,IAAD;AAAOC,cAAAA;AAAP,aAAlC;AACH,WAFD,MAEM;AACF,iBAAKC,QAAL,CAAcI,GAAd,CAAkBP,SAAlB,EAA6B,CAAC;AAACC,cAAAA,IAAD;AAAOC,cAAAA;AAAP,aAAD,CAA7B;AACH;AACJ,SAd8C,CAgB/C;;;AACAM,QAAAA,GAAG,CAACR,SAAD,EAAoBC,IAApB,EAAoC;AACnC,cAAG,KAAKE,QAAL,CAAcC,GAAd,CAAkBJ,SAAlB,CAAH,EAAgC;AAC5B,kBAAMS,KAAK,GAAG,KAAKN,QAAL,CAAcE,GAAd,CAAkBL,SAAlB,EAA6BU,SAA7B,CAAwCC,CAAD,IAAOA,CAAC,CAACV,IAAF,KAAWA,IAAzD,CAAd;AACAQ,YAAAA,KAAK,GAAG,CAAC,CAAT,IAAc,KAAKN,QAAL,CAAcE,GAAd,CAAkBL,SAAlB,EAA6BY,MAA7B,CAAoCH,KAApC,EAA2C,CAA3C,CAAd;AACH;AACJ,SAtB8C,CAwB/C;;;AACAI,QAAAA,IAAI,CAACb,SAAD,EAAoB,GAAGc,MAAvB,EAAyC;AACzC,cAAG,KAAKX,QAAL,CAAcC,GAAd,CAAkBJ,SAAlB,CAAH,EAAgC;AAC5B,iBAAKG,QAAL,CAAcE,GAAd,CAAkBL,SAAlB,EAA6Be,OAA7B,CAAqC,CAAC;AAAEd,cAAAA,IAAF;AAAQC,cAAAA;AAAR,aAAD,KAAkB;AACnD,kBAAGA,GAAH,EAAO;AACHD,gBAAAA,IAAI,CAACe,KAAL,CAAWd,GAAX,EAAgBY,MAAhB;AACH,eAFD,MAEM;AACFb,gBAAAA,IAAI,CAAC,GAAGa,MAAJ,CAAJ;AACH;AACJ,aAND;AAOH;AACJ,SAnC8C,CAqC/C;;;AACAG,QAAAA,KAAK,GAAE;AACH,eAAKd,QAAL,CAAcc,KAAd;AACH;;AAxC8C,O","sourcesContent":["import {ITile} from \"db://assets/Levels\";\nimport Singleton from \"db://assets/Base/Singleton\";\n\ninterface IItem {\n    func: Function,\n    ctx: unknown\n}\n\nexport default class EventManager extends Singleton{\n    static get Instance(){\n        return super.GetInstance<EventManager>()\n    }\n    private eventDic: Map<string, Array<IItem>> = new Map()\n\n    //绑定方法\n    //疑问点：ctx上下文 ？\n    on(eventName: string, func: Function, ctx?: unknown){\n        if(this.eventDic.has(eventName)){\n            this.eventDic.get(eventName).push({func, ctx});\n        }else {\n            this.eventDic.set(eventName, [{func, ctx}]);\n        }\n    }\n\n    //解绑方法\n    off(eventName: string, func: Function) {\n        if(this.eventDic.has(eventName)){\n            const index = this.eventDic.get(eventName).findIndex((i) => i.func === func);\n            index > -1 && this.eventDic.get(eventName).splice(index, 1);\n        }\n    }\n\n    //触发方法\n    emit(eventName: string, ...params: unknown[]){\n        if(this.eventDic.has(eventName)){\n            this.eventDic.get(eventName).forEach(({ func, ctx })=> {\n                if(ctx){\n                    func.apply(ctx, params);\n                }else {\n                    func(...params);\n                }\n            });\n        }\n    }\n\n    //清空事件\n    clear(){\n        this.eventDic.clear();\n    }\n\n}\n"]}