{"version":3,"sources":["file:///Users/lindanian/projects/git/cocos-creator-projects/practice/13-CrampedRoomOfDeath/assets/Scripts/Player/PlayerManager.ts"],"names":["_decorator","Component","Sprite","UITransform","Animation","AnimationClip","animation","TILE_HEIGHT","TILE_WIDTH","ResourceManager","ccclass","property","ANIMATION_SPEED","PlayerManager","init","sprite","addComponent","sizeMode","SizeMode","CUSTOM","transform","getComponent","setContentSize","spriteFrames","Instance","loadDir","animationComponent","animationClip","track","ObjectTrack","path","TrackPath","toComponent","toProperty","frames","map","item","index","channel","curve","assignSorted","addTrack","duration","length","wrapMode","WrapMode","Loop","defaultClip","play"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,a,OAAAA,a;AAAeC,MAAAA,S,OAAAA,S;;AACvEC,MAAAA,W,iBAAAA,W;AAAaC,MAAAA,U,iBAAAA,U;;AACdC,MAAAA,e;;;;;;;OACD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBX,U;AAExBY,MAAAA,e,GAAkB,IAAE,C;;+BAGbC,a,WADZH,OAAO,CAAC,eAAD,C,gBAAR,MACaG,aADb,SACmCZ,SADnC,CAC6C;AACnCa,QAAAA,IAAI,GAAE;AAAA;;AAAA;AACR,gBAAMC,MAAM,GAAG,KAAI,CAACC,YAAL,CAAkBd,MAAlB,CAAf;;AACAa,YAAAA,MAAM,CAACE,QAAP,GAAkBf,MAAM,CAACgB,QAAP,CAAgBC,MAAlC;;AAEA,gBAAMC,SAAS,GAAG,KAAI,CAACC,YAAL,CAAkBlB,WAAlB,CAAlB;;AACAiB,YAAAA,SAAS,CAACE,cAAV,CAAyB;AAAA;AAAA,4CAAa,CAAtC,EAAyC;AAAA;AAAA,8CAAc,CAAvD;AAEA,gBAAMC,YAAY,SAAS;AAAA;AAAA,oDAAgBC,QAAhB,CAAyBC,OAAzB,CAAiC,yBAAjC,CAA3B;;AACA,gBAAMC,kBAAkB,GAAG,KAAI,CAACV,YAAL,CAAkBZ,SAAlB,CAA3B;;AACA,gBAAMuB,aAAa,GAAG,IAAItB,aAAJ,EAAtB;AAEA,gBAAMuB,KAAK,GAAG,IAAItB,SAAS,CAACuB,WAAd,EAAd,CAXQ,CAWmC;;AAC3CD,YAAAA,KAAK,CAACE,IAAN,GAAa,IAAIxB,SAAS,CAACyB,SAAd,GAA0BC,WAA1B,CAAsC9B,MAAtC,EAA8C+B,UAA9C,CAAyD,aAAzD,CAAb,CAZQ,CAY8E;;AACtF,gBAAMC,MAAmC,GAAGX,YAAY,CAACY,GAAb,CAAiB,CAACC,IAAD,EAAOC,KAAP,KAAgB,CAACzB,eAAe,GAAGyB,KAAnB,EAA0BD,IAA1B,CAAjC,CAA5C,CAbQ,CAcR;;AACAR,YAAAA,KAAK,CAACU,OAAN,CAAcC,KAAd,CAAoBC,YAApB,CAAiCN,MAAjC,EAfQ,CAgBR;;AACAP,YAAAA,aAAa,CAACc,QAAd,CAAuBb,KAAvB;AACAD,YAAAA,aAAa,CAACe,QAAd,GAAyBR,MAAM,CAACS,MAAP,GAAgB/B,eAAzC,CAlBQ,CAkBkD;;AAC1De,YAAAA,aAAa,CAACiB,QAAd,GAAyBvC,aAAa,CAACwC,QAAd,CAAuBC,IAAhD;AACApB,YAAAA,kBAAkB,CAACqB,WAAnB,GAAiCpB,aAAjC;AACAD,YAAAA,kBAAkB,CAACsB,IAAnB;AArBQ;AAsBX;;AAvBwC,O","sourcesContent":["import { _decorator, Component, Sprite, UITransform, Animation, AnimationClip, animation, SpriteFrame } from 'cc';\nimport {TILE_HEIGHT, TILE_WIDTH} from \"db://assets/Scripts/Tile/TileManager\";\nimport ResourceManager from \"db://assets/Runtime/ResourceManager\";\nconst { ccclass, property } = _decorator;\n\nconst ANIMATION_SPEED = 1/8;\n\n@ccclass('PlayerManager')\nexport class PlayerManager extends Component {\n    async init(){\n        const sprite = this.addComponent(Sprite);\n        sprite.sizeMode = Sprite.SizeMode.CUSTOM;\n\n        const transform = this.getComponent(UITransform);\n        transform.setContentSize(TILE_WIDTH * 4, TILE_HEIGHT * 4);\n\n        const spriteFrames = await ResourceManager.Instance.loadDir('texture/player/idle/top');\n        const animationComponent = this.addComponent(Animation);\n        const animationClip = new AnimationClip();\n\n        const track = new animation.ObjectTrack(); // 创建一个对象轨道\n        track.path = new animation.TrackPath().toComponent(Sprite).toProperty('spriteFrame'); // 指定轨道路径\n        const frames:Array<[number, SpriteFrame]> = spriteFrames.map((item, index)=> [ANIMATION_SPEED * index, item]);\n        // 为 x 通道的曲线添加关键帧\n        track.channel.curve.assignSorted(frames);\n        // 最后将轨道添加到动画剪辑以应用\n        animationClip.addTrack(track);\n        animationClip.duration = frames.length * ANIMATION_SPEED; // 整个动画剪辑的周期\n        animationClip.wrapMode = AnimationClip.WrapMode.Loop;\n        animationComponent.defaultClip = animationClip;\n        animationComponent.play();\n    }\n}\n\n"]}